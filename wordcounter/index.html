<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><title>glock counter</title><style> * { margin: 0; padding: 0; box-sizing: border-box; } body { font-family: 'Arial Black', Arial, sans-serif; background: transparent; overflow: hidden; width: 100vw; height: 100vh; } .counter-overlay { position: fixed; top: 20px; left: 20px; color: white; font-size: 24px; font-weight: bold; text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8); white-space: nowrap; transition: all 0.3s ease; } .counter-overlay.increment { animation: flash 0.5s ease-out; } @keyframes flash { 0% { transform: scale(1); } 50% { color: #ff518b; text-shadow: 2px 2px 8px rgba(255, 0, 128, 0.8); transform: scale(1.05); } 100% { color: white; text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8); transform: scale(1); } } .count-number { color: #ff1d68; font-size: 1.2em; } .debug-info { position: fixed; bottom: 20px; right: 20px; background: rgba(0, 0, 0, 0.8); color: #ccc; padding: 10px; border-radius: 5px; font-size: 12px; font-family: monospace; display: none; max-width: 320px; max-height: 40vh; overflow: auto; font-weight: normal; } .debug-mode .debug-info { display: block; } .status-indicator { position: fixed; top: 20px; right: 20px; width: 12px; height: 12px; border-radius: 50%; background: #ff4444; display: none; } .debug-mode .status-indicator { display: block; } @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } } </style></head><body><div id="counterOverlay" class="counter-overlay"><span id="wordLabel">WORD</span> COUNTER: <span id="countNumber" class="count-number">0</span></div><div id="debugInfo" class="debug-info"><div>targetWord: "<span id="debugTarget">-</span>"</div><div>status: <span id="debugStatus">-</span></div><div>total: <span id="debugMatches">0</span></div><div style="margin-top: 8px;">transcript:</div><div id="debugTranscripts" style="max-height: 200px; overflow-y: auto; font-size: 11px; line-height: 1.3; background: #111; padding: 5px; border-radius: 4px;"></div></div><script> class WordCounterOverlay { constructor() { this.recognition = null; this.isListening = false; this.targetWords = []; this.count = 0; this.isDebugMode = false; this.totalMatches = 0; this.counterOverlay = document.getElementById('counterOverlay'); this.countNumber = document.getElementById('countNumber'); this.wordLabel = document.getElementById('wordLabel'); this.debugInfo = document.getElementById('debugInfo'); this.init(); } init() { this.parseUrlParams(); if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) { this.updateDebugStatus('speech recognition not supported'); return; } this.setupSpeechRecognition(); setTimeout(() => this.startListening(), 500); this.setupAutoRestart(); } parseUrlParams() { const urlParams = new URLSearchParams(window.location.search); const wordParam = urlParams.get('words') || urlParams.get('target') || 'word'; if (wordParam.includes(',')) { this.targetWords = wordParam.split(',').map(w => w.trim().toLowerCase()); } else { this.targetWords = [wordParam.trim().toLowerCase()]; } this.isDebugMode = urlParams.get('debug') === 'true'; if (this.isDebugMode) { document.body.classList.add('debug-mode'); document.getElementById('debugTarget').textContent = this.targetWords.join(', '); } this.updateWordLabel(); } setupSpeechRecognition() { const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition; this.recognition = new SpeechRecognition(); this.recognition.continuous = true; this.recognition.interimResults = false; this.recognition.lang = 'en-US'; this.recognition.maxAlternatives = 1; this.recognition.onstart = () => { this.isListening = true; this.updateDebugStatus('listening...'); }; this.recognition.onend = () => { this.isListening = false; this.updateDebugStatus('stopped'); }; this.recognition.onresult = (event) => { let transcript = ''; for (let i = event.resultIndex; i < event.results.length; i++) { if (event.results[i].isFinal) { transcript += event.results[i][0].transcript; } } this.checkForTargetWords(transcript.trim()); }; this.recognition.onerror = (event) => { this.updateDebugStatus(`Error: ${event.error}`); if (['no-speech', 'aborted'].includes(event.error)) { setTimeout(() => { if (!this.isListening) this.startListening(); }, 1000); } }; } checkForTargetWords(transcript) { if (!transcript) return; let matchCount = 0; this.targetWords.forEach(word => { const regex = new RegExp(`\\b${word}\\b`, 'gi'); const matches = transcript.match(regex); if (matches) { matchCount += matches.length; } }); if (matchCount > 0) { this.incrementCounter(matchCount); } if (this.isDebugMode) { this.appendDebugTranscript(transcript); } } appendDebugTranscript(sentence) { const container = document.getElementById('debugTranscripts'); const entry = document.createElement('div'); entry.textContent = sentence; container.appendChild(entry); container.scrollTop = container.scrollHeight; } incrementCounter(amount = 1) { this.count += amount; this.totalMatches += amount; this.updateDisplay(); this.counterOverlay.classList.add('increment'); setTimeout(() => { this.counterOverlay.classList.remove('increment'); }, 500); if (this.isDebugMode) { document.getElementById('debugMatches').textContent = this.totalMatches; } } updateDisplay() { this.countNumber.textContent = this.count; } updateWordLabel() { this.wordLabel.textContent = this.targetWords[0].toUpperCase(); } updateDebugStatus(status) { if (this.isDebugMode) { document.getElementById('debugStatus').textContent = status; } } startListening() { if (!this.recognition) return; if (this.isListening) { this.updateDebugStatus('already listening...'); return; } try { this.recognition.start(); this.isListening = true; } catch (error) { this.updateDebugStatus(`error: ${error.message}`); } } stopListening() { if (this.recognition && this.isListening) { this.recognition.stop(); } } resetCounter() { this.count = 0; this.totalMatches = 0; this.updateDisplay(); if (this.isDebugMode) { document.getElementById('debugMatches').textContent = '0'; document.getElementById('debugTranscripts').innerHTML = ''; } } setupAutoRestart() { setInterval(() => { if (!this.isListening && this.recognition) { this.startListening(); } }, 5000); setInterval(() => { if (this.count > 9999) { this.resetCounter(); } }, 3600000); } } let wordCounter; document.addEventListener('DOMContentLoaded', () => { wordCounter = new WordCounterOverlay(); }); document.addEventListener('keydown', (e) => { if (e.key === 'r' && e.ctrlKey) { e.preventDefault(); wordCounter.resetCounter(); } }); document.addEventListener('visibilitychange', () => { if (document.hidden) { wordCounter.stopListening(); } else { setTimeout(() => { wordCounter.startListening(); }, 1000); } }); </script></body></html>